/* Thiết lập màu sắc chung */
#Menu_BatDau {
  background-color: #ff5733; /* Màu nền menu */
  text-align: center; /* Căn giữa nội dung */
  padding: 20px;
  border-radius: 10px; /* Bo góc */
}
#Menu_BatDau_h1 {
  color: white; /* Màu chữ của tiêu đề */
}
/* Navbar */
.Menu_NavBar {
  padding: 10px;
}
.NutNhan_NavBar {
  font-size: 16px;
  padding: 8px 12px;
  border-radius: 5px;
}
/* Canvas Game */
#Game_Canvas{
  border: 2px solid #ff5733; /* Viền game màu cam */
  display: block;
  width: 90%;
  max-width: 500px;
  margin: auto;
}
/* Footer */
Game_Footer {
  background: #222;
  text-align: center;
  padding: 15px;
  color: white;
}

/* Nút Menu */
#NutNhan_Menu{
  background: white;
  color: black;
  padding: 10px;
  font-size: 18px;
  border-radius: 5px;
}
#NutNhan_BatDau:hover {
  background: black;
  color: white;
  transform: scale(1.1);
}
/* Nút Cài đặt */
#NutNhan_CaiDat{
  background: gray;
  color: white;
  padding: 10px;
  font-size: 18px;
  border-radius: 5px;
}

<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Game Hứng Táo</title>
    <link rel="stylesheet" href="/style.css">
</head>
<body>

    <!-- Navbar điều khiển -->
    <nav id="Game_NavBar">
        <button id="pauseBtn">Tạm dừng</button>
        <button id="resumeBtn">Tiếp tục</button>
        <button id="menuBtn">Menu</button>
    </nav>

    <!-- Menu bắt đầu -->
    <div id="Menu_BatDau">
        <h1 id="Menu_TieuDe">Game Hung Trai Cay</h1>
        <button id="NutNhan_BatDau">Choi ngay</button>
        <button id="NutNhan_CaiDat">Cai dat(chua co san)</button>
    </div>

    <!-- Khu vực game -->
    <main id="Frame_Game">
        <canvas id="Game_Canvas"></canvas>
    </main>

    <!-- Footer -->
    <footer id="Game_Footer">
        <p>&copy; 2025 - Developed by HaHuyNam</p>
    </footer>

    <script src="/main.js"></script>

</body>
</html>

import "./style.css";
import Phaser from "phaser";

const KichThuoc = { Rong: 500, Cao: 500 };
const TocDo_Roi = 300;
let Game_DangTamDung = false;

const Canvas_Game = document.getElementById("Canvas_Game");
const Menu_BatDau = document.getElementById("Menu_BatDau");
const NutNhan_BatDau_Game = document.getElementById("NutNhan_BatDau_Game");

const NutNhan_TamDung_Game = document.getElementById("NutNhan_TamDung_Game");
const NutNhan_TiepTuc_Game = document.getElementById("NutNhan_TiepTuc_Game");
const NutNhan_Menu_Game = document.getElementById("NutNhan_Menu_Game");

class ManChoi_Game extends Phaser.Scene {
  constructor() {
    super("ManChoi_Game");
    this.GioHung = null;
    this.Tao = null;
    this.DiemSo = 0;
    this.BanPhim = null;
    this.VanBan_DiemSo = null;
    this.ThoiGian_Choi = 0;
  }

  // Tải tài nguyên
  preload() {
    this.load.image("NenGame", "/assets/bg.png");
    this.load.image("GioHung", "/assets/basket.png");
    this.load.image("Tao", "/assets/apple.png");
    this.load.audio("AmThanh_Diem", "/assets/coin.mp3");
    this.load.audio("NhacNen", "/assets/bgMusic.mp3");
  }

  create() {
    this.add.image(0, 0, "NenGame").setOrigin(0, 0);
    this.VanBan_ThoiGian = this.add.text(10, 40, "Thời gian: 0s", { font: "25px Arial", fill: "#ffffff" });

    // Âm thanh
    this.AmThanh_Diem = this.sound.add("AmThanh_Diem");
    this.NhacNen = this.sound.add("NhacNen", { loop: true, volume: 0.5 });

    // Tạo giỏ hứng
    this.GioHung = this.physics.add.image(KichThuoc.Rong / 2, KichThuoc.Cao - 100, "GioHung").setOrigin(0.5, 0);
    this.GioHung.setCollideWorldBounds(true);

    // Táo rơi
    this.Tao = this.physics.add.image(this.LayViTriTao_NgauNhien(), 0, "Tao").setOrigin(0.5, 0);
    this.Tao.setVelocityY(TocDo_Roi);

    this.physics.add.overlap(this.Tao, this.GioHung, this.BatTao, null, this);

    this.BanPhim = this.input.keyboard.createCursorKeys();
    this.VanBan_DiemSo = this.add.text(10, 10, "Điểm số: 0", { font: "25px Arial", fill: "#ffffff" });

    this.scene.pause("ManChoi_Game");
  }

  update(thoiGian, delta) {
    if (Game_DangTamDung) return;

    // Cập nhật thời gian chơi
    this.ThoiGian_Choi += delta / 1000;
    this.VanBan_ThoiGian.setText(`Thời gian: ${Math.floor(this.ThoiGian_Choi)}s`);

    // Di chuyển giỏ hứng
    const { left, right } = this.BanPhim;
    this.GioHung.setVelocityX(left.isDown ? -300 : right.isDown ? 300 : 0);

    // Táo rơi xuống thì đặt lại vị trí
    if (this.Tao.y >= KichThuoc.Cao) {
      this.DatLaiViTriTao();
    }
  }

  LayViTriTao_NgauNhien() {
    return Math.floor(Math.random() * (KichThuoc.Rong - 20)) + 10;
  }

  BatTao() {
    this.DatLaiViTriTao();
    this.DiemSo++;
    this.VanBan_DiemSo.setText(`Điểm số: ${this.DiemSo}`);
    this.AmThanh_Diem.play();
  }

  DatLaiViTriTao() {
    this.Tao.setY(0);
    this.Tao.setX(this.LayViTriTao_NgauNhien());
  }

  KhoiDongLai_Game() {
    this.DiemSo = 0;
    this.VanBan_DiemSo.setText("Điểm số: 0");
    this.ThoiGian_Choi = 0;
    this.VanBan_ThoiGian.setText("Thời gian: 0s");
    this.DatLaiViTriTao();
  }
}

// Cấu hình game
const CauHinh_Game = {
  type: Phaser.WEBGL,
  width: KichThuoc.Rong,
  height: KichThuoc.Cao,
  canvas: Canvas_Game,
  physics: { default: "arcade", arcade: { gravity: { y: 0 } } },
  scene: [ManChoi_Game],
};

// Khởi động game
const Game = new Phaser.Game(CauHinh_Game);
const ManChoi_Game_HienTai = Game.scene.getScene("ManChoi_Game");

NutNhan_TamDung_Game.addEventListener("click", () => {
  Game.scene.pause("ManChoi_Game");
  Game_DangTamDung = true;
  HienThi_TrangThai("Game tạm dừng");
});

NutNhan_TiepTuc_Game.addEventListener("click", () => {
  Game.scene.resume("ManChoi_Game");
  Game_DangTamDung = false;
  HienThi_TrangThai("Game tiếp tục");
});

NutNhan_Menu_Game.addEventListener("click", () => {
  ManChoi_Game_HienTai.scene.restart();
  Game.scene.pause("ManChoi_Game");
  Menu_BatDau.style.display = "flex";
  Game_DangTamDung = true;
  ManChoi_Game_HienTai.NhacNen.stop();

  alert(`Điểm số: ${ManChoi_Game_HienTai.DiemSo}\nThời gian chơi: ${Math.floor(ManChoi_Game_HienTai.ThoiGian_Choi)}s`);
});

NutNhan_BatDau_Game.addEventListener("click", () => {
  Menu_BatDau.style.display = "none";
  Game.scene.resume("ManChoi_Game");

  if (!ManChoi_Game_HienTai.NhacNen.isPlaying) {
    ManChoi_Game_HienTai.NhacNen.play();
  }
});

const TrangThai_Game = document.getElementById("statusDiv");

function HienThi_TrangThai(thongBao) {
  TrangThai_Game.textContent = thongBao;
  TrangThai_Game.style.display = "block";

  setTimeout(() => {
    TrangThai_Game.style.display = "none";
  }, 2000);
}
